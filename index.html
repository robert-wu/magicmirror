<!DOCTYPE html>
<head>
	<title> Smart Mirror </title>
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600' rel='stylesheet' type='text/css'>
	<style>
		body {
			min-height:100%;
			padding:0;
			margin: 0;
			background-color: rgba(0,0,0,1);
			font-family: 'Open Sans', sans serif;
		}

		#canvas {
			/**background-color: rgba(0,0,0,1);**/
			background-color:black;
			min-width: 50%;
			min-height: 100vh;
			margin-left: 25%;
			margin-right:25%;
			z-index: -100;
			position: absolute;
			
			bottom:0;
		}

		#overlay {
			z-index: 100;
			position:absolute;
			/**top:-10;**/
			min-width: 100%;
			min-height: 100vh;
			bottom:0;
		
		}

		#left {
			float: left;
			
			top:0;
			bottom:0;
			left:0;
			
			/*background-color: rgba(255,255,255,0.75);*/
			width: 30%;
			min-height:100vh;
			padding-top: 5%;
			
		}

		#right {
			margin-left: 75%;
			z-index: 200;
			width: 30%;
			/*background-color: rgba(255,255,255,0.75);*/
			/**left:0;**/
			top:0;
			bottom:0;
			min-height: 100vh;
			
		}

		#time {
			color: rgba(255,255,255,1);
			/**background-color: rgba(255,255,255,0.75);**/
			width: 100%;
			height: 30%;
			font-size: 4em;
			padding:0;
			margin:0;
		}

		#weather {
			color: rgba(255,255,255,1);
			/**background-color: rgba(255,255,255,0.75);**/
			width: 100%;
			height: 30%;
			font-size: 3em;
		}

		#flame{
			z-index: 300;
			top:0;
			margin-left: 300%;
			margin-top: 50%;
		}

		#weather img {
			width: 50%;
		}

		#temperature {
			float: left;
		}

		#tempNext {
			float: left;
		}

		#heartbeat {
			color: rgba(255,255,255,1);
			/**background-color: rgba(255,255,255,0.75);**/
			width: 100%;
			height: 30%;
		}

		#heartQuantity {
			float: left;
			text-align: center;
			color: rgba(255, 255, 255, 1);
			padding: 0;
			margin: 0;
			font-size: 3em;
		}

		#heartNext {
			float: left;
			text-align: center;
			color: rgba(255, 255, 255, 1);
			padding: 0;
			margin: 0;
			font-size: 3em;
		}

		.heart {
			font-size: 200px;
			text-align: center;
			/**color: rgba(165, 25, 25, 1);**/
			color: rgba(255,255,255,1);
			padding: 0;
			margin: 0;
		}


		.pulse2 {
			-webkit-animation: pulse2 1s linear infinite;
			-moz-animation: pulse2 1s linear infinite;
			-ms-animation: pulse2 1s linear infinite;
			animation: pulse2 1s linear infinite;
		}

		@keyframes "pulse2" {
		 0% {
		    -webkit-transform: scale(1.1);
		   	-moz-transform: scale(1.1);
		   	-o-transform: scale(1.1);
		   	-ms-transform: scale(1.1);
		   	transform: scale(1.1);
		 }
		 50% {
		    -webkit-transform: scale(0.8);
		   	-moz-transform: scale(0.8);
		   	-o-transform: scale(0.8);
		   	-ms-transform: scale(0.8);
		   	transform: scale(0.8);
		 }
		 100% {
		    -webkit-transform: scale(1);
		   	-moz-transform: scale(1);
		   	-o-transform: scale(1);
		   	-ms-transform: scale(1);
		   	transform: scale(1);
		 }

		}

		@-moz-keyframes pulse2 {
		 0% {
		   -moz-transform: scale(1.1);
		   transform: scale(1.1);
		 }
		 50% {
		   -moz-transform: scale(0.8);
		   transform: scale(0.8);
		 }
		 100% {
		   -moz-transform: scale(1);
		   transform: scale(1);
		 }

		}

		@-webkit-keyframes "pulse2" {
		 0% {
		   -webkit-transform: scale(1.1);
		   transform: scale(1.1);
		 }
		 50% {
		   -webkit-transform: scale(0.8);
		   transform: scale(0.8);
		 }
		 100% {
		   -webkit-transform: scale(1);
		   transform: scale(1);
		 }

		}

		@-ms-keyframes "pulse2" {
		 0% {
		   -ms-transform: scale(1.1);
		   transform: scale(1.1);
		 }
		 50% {
		   -ms-transform: scale(0.8);
		   transform: scale(0.8);
		 }
		 100% {
		   -ms-transform: scale(1);
		   transform: scale(1);
		 }






	</style>

	
	<script src="http://code.jquery.com/jquery-2.2.1.min.js"></script>
	
	<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
	<script>

		var temp = 00;

		function onLoad() {
			//update time
			//update weather
			//update heart beat
			//load text messages
			//searching for voice symbol
			//var socket = io('http://172.20.10.12:3003');
			var socket = io('http://172.20.10.2:3006');
			socket.emit('CH02','web-weather,temp,beat,lefthandx,lefthandy,stock');
			//var socket2 = io('http://172.20.10.12:3003')
			socket.on('CH02', function (data) {
				console.log(data);
				var json = data.split(",");
				console.log("First element is: " + json[0]);
				for (var i = 0; i< json.length; i++) {
					var len = json[i].length;
					if (i==0) { //weather
						
						var weather = json[i].substring(8, len);
						if (weather!="undefined") {
							console.log(weather);
							//document.getElementById();
							updateWeather(weather);
						}
					}
					else if (i==1) { //temperature
						
						var temperature = json[i].substring(5,len);
						if (temperature!="undefined") {
							console.log("attempting to update temperature");
							document.getElementById("temperature").innerHTML = Math.round(temperature);

						}
					}
					else if (i==2) { //heartbeat
						var beat = json[i].substring(5, len);
						if (beat!="undefined") {
							console.log(beat);
							document.getElementById("heartQuantity").innerHTML = beat;
						}
					}
					else if (i==3) { //lefthandx and lefthandy skip 3
						var lx = json[3].substring(10,len);
						var ly = json[4].substring(11,len);
						if (lx!="undefined" && ly!="undefined") {
							console.log(lx+","+ly);
							updateFlame(parseFloat(lx),parseFloat(ly));
						}

					}
					else if (i==5) { //stock
						var stock = json[i].substring(6,len)
						if (stock!="undefined") {
							console.log(stock);
							updateStock();
						}
					}
				}
				setTimeout(function(){
  					//your code to be executed after 1 seconds
  					socket.emit('CH02','web-weather,temp,beat,lefthandx,lefthandy,stock');
				}, 200); 
				
			});
		}

		function updateTime() {
			var d = new Date();
			d.getHours(); // => 9
			d.getMinutes(); // =>  30
			d.getSeconds(); // => 51
			//document.getElementById("").innerHTML = "";
		}

		function updateTemp() {

		}

		function updateWeather(weather) {
			if (weather=="Clear") {
				document.getElementById("icon").src = "drawables/clear_day.png";
			}
			else if (weather=="Cloudy"){
				document.getElementById("icon").src = "drawables/cloudy.png";
			}
			else if (weather=="Fog") {
				document.getElementById("icon").src = "drawables/fog.png";
			}
			else if (weather=="Partly Cloudy") {
				document.getElementById("icon").src = "drawables/partly_cloudy.png";
			}
			else if (weather=="Rain") {
				document.getElementById("icon").src = "drawables/rain.png";
			}
			else if (weather=="Sleet") {
				document.getElementById("icon").src = "drawables/sleet.png";
			}
			else if (weather=="Snow") {
				document.getElementById("icon").src = "drawables/snow.png";
			}
			else if (weather=="Sunny") {
				document.getElementById("icon").src = "drawables/sunny.png";
			}
			else if (weather=="Wind") {
				document.getElementById("icon").src = "drawables/wind.png";
			}
		}

		function updateHeart() {

		}

		function updateStock() {

		}

		function updateArrow(){

		}
		var oldlx=0;
		var oldly=0;
		var countFlame=0;

		function updateFlame(x,y){
			if(x!=oldlx || y!=oldly){
				document.getElementById("fire").src = './images/fire' + (countFlame%5+1) + '.jpg';
				$('#flame').css('margin-left',(75+300*(x-.5))+'%');
				$('#flame').css('margin-top',(50+300*(.5-y))+'%');
				oldlx=x;
				oldly=y;
				countFlame++;
				console.log(countFlame+(50+200*(x-.5))+'%'+(50+200*(y-.5))+'%'+x+y);
			}
			else{
				$('#flame').css('margin-left','299%');
			}
		}


	</script>

	


</head>

<body onload="onLoad()">
	<div id="canvas">
		<div id="flame">
			<img id="fire" src="images/fire1.jpg">
		</div>
	</div>
	<div id="overlay"> 
		<div id="left">
			<!--<div id= "time">
				<center> <p> 8:56 PM </p> </center>
			</div> -->
			<div id="weather">
				<center>
				<img id="icon" src="drawables/rain.png">
				 <p> <div id = "temperature"> 00 </div> <div id="tempNext"> &deg;F </p>
				</center>
			</div>
			<div id="heartbeat">
				<div class="heart pulse2">
					&hearts;
				</div>
				<div>
					<center> <p id = "heartQuantity"> 00 </div> <div id="heartNext">bpm</div> </p> </center>
				</div>
			</div>
		</div>
		<div id="right">
			<div id= "time">
				<center> <p> 8:56 PM </p> </center>
			</div>
		</div>
	</div>

</body>

</html>